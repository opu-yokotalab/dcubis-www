[[進捗/2007]]

*研究についてのまとめ [#nd627c82]

**研究目的 [#n26faccf]

-PasQにおいて、閲覧者が空間を閲覧する際、自然に空間を閲覧できるようなウォークスルー面の向上~
~
**問題点 [#f0410e85]

-屋外のように広く見通しの良い空間を仮想空間化した際（ex:県立大学）、
--前進して切替った時、近づいていたものが遠くに見えてしまう不自然さがある~
→切替時のタイミングが合っていないため、近づいている感覚が得にくい
--パノラマ画像間の距離が遠い場合の切替り~
→画像が急に切替ってしまうため、切替ったという感覚が分かりにくい
-
といった問題が顕著に現れやすい~
→近景・遠景での移動距離（切替点）を一律で決めてしまっているのがまずい

-障害物を通り抜けた際の扱いが定まっていないため、通り抜けた感覚が得にくい
-切替時の方向（パン角）にずれが生じる~
//-ユーザーインタフェースが不親切~

**解決策とアプローチ [#z6992788]

***見ている範囲と同じになるようなタイミングで切替るような切替点を見つける [#c88220db]

-切替わった後のパノラマ画像が、現在のパノラマ画像と似ていれば良い~

--テンプレートマッチングを用いた位置・方位推定の際に、画像の類似度を取得~
現在のパノラマ画像をズームしていき、最も類似度が高くなった時、その時に切替るようにする

--その時のズーム倍率（=切替倍率）を取得、PTViewerで扱える形(=視野角)に換算させることにより、~
切替るタイミング(=切替視野角)を得ることが可能に

***切替視野角がうまく取得できない場合 [#k9021eb9]

-パノラマ画像間で、片方のみ切替視野角を得ることが出来た場合

--取得できた方の切替視野角を、取得できなかった方の視野角として扱う~
(ex:パノラマ画像A、Bがある場合、A⇔B間のうちB→A間でのみ切替視野角が得られた場合、~
A→B間の切替視野角はB→A間のものと同じとみなす)

-画像間の類似度が高くない場合

--障害物を挟む場合、もしくは画像間の距離が遠すぎる場合、切替時に何らかの演出を挟む

--それらに該当しない場合は、既存の切替判定(視野角の閾値を用いた判定)を適用する

//-障害物・遠距離の扱い

//--画像間の距離の平均を算出、その平均距離よりも長ければ遠距離とみなす~
//そうでなければ遠距離ではないとする~
//類似度が著しく低く、かつ遠距離でなければ、現在の画像に障害物があるとみなす~
//→前処理の段階で見つけてしまう手も?

***切替情報 [#s6456db0]

切替に関する情報を、PCD等と同じように予め持たせてしまう

-必要な情報
--テンプレートマッチングが出来たかどうか：出来た時には切替視野角を求めることが可能に~
出来なければ障害物であったり遠距離であったりといった事が考えられる
--切替視野角:テンプレートマッチングの結果により取得。~
場合によっては切替倍率を持たせて、内部処理で視野角へ換算させるという手も？
--障害物が間にあるかどうか:テンプレートマッチングの結果により取得
--遠距離であるかどうか
--切り替える方向（角度）:あるパノラマから見て、パノラマがある方向はどこになるのか
--パノラマID:パノラマ間の関係（どのパノラマとパノラマが切り替えられるか）を持っておく。~
切替える方向から取得
--距離:距離が近い方を優先的に切替る際に必要になるか



*タスク [#o8536ec6]

-切替情報の付加に関して
--切替倍率~
→何を基準にした際の倍率であれば良いのか？　
--切替視野角と切替倍率との対応~
%%→進捗報告の際に挙げた式で良いのか？%%~
→PasQ会議の際に挙げられた式との対応の検討を~
また、マッチングの探索範囲によって値が変化しないだろうか？
//--パノラマ間の関係を有向グラフの形で表せるようにするには？
--DBとの連携についても頭に入れておかなければ
--どうやって情報を吐き出すか？
-PasQエンジン
--切替判定部は弄る必要あり（場合によっては新たに関数を用意する必要も）
--その他改良しなければならない箇所も？
-論文の執筆も書ける所から

#pcomment
